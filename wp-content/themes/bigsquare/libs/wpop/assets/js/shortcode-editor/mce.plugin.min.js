/**
 * Wordspop Shortcodes TinyMCE plugins
 * Version 1.0
 *
 * Copyright (c) 2011 Wordspop
 * Licensed under the Apache License, Version 2.0 http://www.apache.org/licenses/LICENSE-2.0
 */
(function(b){var a="";var c="";tinymce.create("tinymce.plugins.wpopshortcode",{editor:null,init:function(f,e){var d=this;d.editor=f;a=e.replace(/\/js\/shortcode-editor$/,"");f.addCommand("WPopOpenDialog",function(g){b.get(ajaxurl,{action:"wpop_dialog_shortcode",tag:g.tag},function(i){b("#wpop-shortcode-dialog").remove();b("body").append(i);b("#wpop-shortcode-dialog").hide();var h=b(window).height()-84;tb_show('Insert "'+g.title+'" Shortcode',"#TB_inline?inlineId=wpop-shortcode-dialog&width=640&height="+h)})})},getInfo:function(){return{longname:"Wordspop Shortcode Plugin",author:"Wordspop",authorurl:"http://wordspop.com/",infourl:"http://docs.wordspop.com/shortcodes",version:"1.0"}},createControl:function(g,f){var e=this;if(g=="wpop_shortcode"){var i=f.createMenuButton("wpop_shortcode_button",{title:"Insert Wordspop Shortcode",image:a+"/images/editor-wordspop-shortcode.png",icons:false});var d=[],h=parent=null;i.onRenderMenu.add(function(j,k){b.each(WPop_shortcodes,function(l,m){parent=k;if(m.menu_group){h=null;b.each(d,function(n,o){if(o.title==m.menu_group){h=o.menu}});if(h===null){h=k.addMenu({title:m.menu_group});d.push({title:m.menu_group,menu:h})}parent=h}if(m.show_dialog===false){e.insertDirectly(parent,m)}else{e.insertByDialog(parent,m)}})});return i}return null},insertByDialog:function(e,d){e.add({title:d.title,onclick:function(){tinyMCE.activeEditor.execCommand("WPopOpenDialog",d)}})},insertDirectly:function(f,e){var d=this;f.add({title:e.title,onclick:function(){var g="["+e.tag+"]";if(e.close_tag===true){if(d.editor.selection.getContent().length>0){g+=d.editor.selection.getContent()}g+="[/"+e.tag+"]"}tinyMCE.activeEditor.execCommand("mceInsertContent",false,g)}})}});tinymce.PluginManager.add("wpopshortcode",tinymce.plugins.wpopshortcode)})(jQuery);