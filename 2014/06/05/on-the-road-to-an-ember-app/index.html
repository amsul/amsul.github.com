<!doctype html>

<html lang="en">


    <meta charset="utf-8">

    <meta name="author" content="Amsul - http://amsul.ca/">
    <meta name="copyright" content="&copy; Amsul">
    

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@amsul_">
    <meta name="twitter:domain" content="amsul.ca">
    <meta name="twitter:creator" content="@amsul_">
    
        
            <meta name="twitter:title" content="On the road to an Ember app / Amsul">
        
    
    

    <meta name="viewport" content="width=device-width">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">

    <meta http-equiv="cleartype" content="on">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">


    
        
            <title>On the road to an Ember app / Amsul</title>
        
    


    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:300italic,600italic,800italic,300,600,800">
    <link rel="stylesheet" href="/css/style.css">


    <script src="/js/shiv.js"></script>



    

        <div class="menu">
            <nav class="menu__nav" id="menu">
                <div class="content content--flat-bottom">
                    <a class="menu__button-close" href="#"></a>
                    <div class="content__box">
                        <h4 class="title--flat emphasize">Menu</h4>
                    </div>
                </div>
                <div class="content content-freeform content--pad-bottom">
                    <ul class="list--plain list--flat">
                        <li class="list__item">
                            <a class="link--block" href="/">
                                <div class="content">
                                    <div class="content__box content__box--pad-half">Home</div>
                                </div>
                            </a>
                        </li>
                        <li class="list__item">
                            <a class="link--block" href="/notepad">
                                <div class="content">
                                    <div class="content__box content__box--pad-half">Notepad</div>
                                </div>
                            </a>
                        </li>
                        <li class="list__item">
                            <a class="link--block" href="https://github.com/amsul?tab=repositories">
                                <div class="content">
                                    <div class="content__box content__box--pad-half">Projects</div>
                                </div>
                            </a>
                        </li>
                        <li class="list__item">
                            <a class="link--block" href="/me">
                                <div class="content">
                                    <div class="content__box content__box--pad-half">Me</div>
                                </div>
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>
            <aside class="menu__toggler alignright">
                <a class="menu__opener button-menu button-menu--inverse" href="#menu"></a>
                <a class="menu__closer button-menu button-menu--inverse" href="#"></a>
            </aside>
        </div> <!-- .menu -->

    


    <header class="header header--colored">
        <div class="content">
            <div class="content__box content__box--pad-one">
                
                    <h1 class="header__wrapper title--base-size title--thin title--flat">
                        <a class="header__link header__link--dimmed title--dimmed" href="#menu">
                            
                                Hi, I&rsquo;m <b>Amsul</b>.
                            
                        </a>
                    </h1>
                
                
                    <div class="header__title aligncenter">
                        
                            <p class="content__subtitle title--dimmed">June 05, 2014</p>
                        
                        
                            <h1 class="title title--thin title--flat">On the road to an Ember app</h1>
                        
                    </div>
                
            </div>
        </div>
    </header> <!-- .header -->


    <article class="content">
    <div class="content__box content__body">

        

            <p>I absolutely love <a href="http://emberjs.com/">Ember.js</a>. The framework is extremely powerful and is able to handle so much boilerplate that developing an Ember app is a real joy.</p>

<p>I always imagined that converting an existing large, “multi-page” site into an Ember app would be a complicated process. But it recently occurred to me that it might be easier than expected&hellip; once we sacrifice the router and temporarily transition through a hybrid Ember site.</p>

<h3>The markup</h3>

<p>Let’s say we have a homepage:</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="c">&lt;!-- home.html --&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;header&gt;&lt;/header&gt;</span>
    <span class="nt">&lt;h1&gt;</span>Homepage<span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;footer&gt;</span>
        <span class="nt">&lt;button</span> <span class="na">id=</span><span class="s">&quot;press-me&quot;</span><span class="nt">&gt;</span>Press me!<span class="nt">&lt;/button&gt;</span>
    <span class="nt">&lt;/footer&gt;</span>
<span class="nt">&lt;/body&gt;</span>
</code></pre></div>
<p>And an about page:</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="c">&lt;!-- about.html --&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;header&gt;&lt;/header&gt;</span>
    <span class="nt">&lt;h1&gt;</span>About<span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;footer&gt;</span>
        <span class="nt">&lt;button</span> <span class="na">id=</span><span class="s">&quot;press-me&quot;</span><span class="nt">&gt;</span>Press me!<span class="nt">&lt;/button&gt;</span>
    <span class="nt">&lt;/footer&gt;</span>
<span class="nt">&lt;/body&gt;</span>
</code></pre></div>
<p>To Ember-ify this, we basically move all the page-specific content into an “index” template within those pages:</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="c">&lt;!-- home.html --&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/x-handlebars&quot;</span> <span class="na">data-template-name=</span><span class="s">&quot;index&quot;</span><span class="nt">&gt;</span>
        <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Homepage</span><span class="o">&lt;</span><span class="err">/h1&gt;</span>
    <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/body&gt;</span>
</code></pre></div><div class="highlight"><pre><code class="language-html" data-lang="html"><span class="c">&lt;!-- about.html --&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/x-handlebars&quot;</span> <span class="na">data-template-name=</span><span class="s">&quot;index&quot;</span><span class="nt">&gt;</span>
        <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">About</span><span class="o">&lt;</span><span class="err">/h1&gt;</span>
    <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/body&gt;</span>
</code></pre></div>
<p>And move the rest into the application template:</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="c">&lt;!-- application.hbs --&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;header&gt;&lt;/header&gt;</span>
    {{outlet}}
    <span class="nt">&lt;footer&gt;</span>
        <span class="nt">&lt;button</span> <span class="na">id=</span><span class="s">&quot;press-me&quot;</span><span class="nt">&gt;</span>Press me!<span class="nt">&lt;/button&gt;</span>
    <span class="nt">&lt;/footer&gt;</span>
<span class="nt">&lt;/body&gt;</span>
</code></pre></div>
<h3>The scripts</h3>

<p>Let’s say our original scripts are something like this:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">init</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#press-me&#39;</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;hi there!&#39;</span><span class="p">)</span>
    <span class="p">})</span>
<span class="p">}</span>

<span class="c1">// When the document is ready, initialize the scripts.</span>
<span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="nx">init</span><span class="p">)</span>
</code></pre></div>
<p>In order to let Ember take over, we need to do some setup <em>before</em> initializing the scripts. So we change it to something like this:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">init</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#press-me&#39;</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;hi there!&#39;</span><span class="p">)</span>
    <span class="p">})</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">App</span> <span class="o">=</span> <span class="nx">Em</span><span class="p">.</span><span class="nx">Application</span><span class="p">.</span><span class="nx">create</span><span class="p">()</span>

<span class="c1">// Disable the router.</span>
<span class="nx">App</span><span class="p">.</span><span class="nx">Router</span><span class="p">.</span><span class="nx">reopenClass</span><span class="p">({</span>
    <span class="nx">location</span><span class="o">:</span> <span class="s1">&#39;none&#39;</span>
<span class="p">})</span>

<span class="c1">// Once the `index` template of each individual page is</span>
<span class="c1">// inserted into the DOM, initialize the non-Ember scripts.</span>
<span class="nx">App</span><span class="p">.</span><span class="nx">IndexView</span> <span class="o">=</span> <span class="nx">Em</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">didInsertElement</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">init</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">})</span>
</code></pre></div>
<h3>And that’s pretty much it <img alt="smile" src="https://github.global.ssl.fastly.net/images/icons/emoji/smile.png" class="emoji" /></h3>

<p>We got our old application code working as it was before without having to tweak it. And we can build any new features using the power of Ember views.</p>

<p>However, we obviously don’t want to <strong>not</strong> use the epic Ember router. That would be a tragedy. But that is also the trickier part. It heavily depends on your backend setup and your ability to map your URLs over correctly to the Ember router.</p>

<p>That is out of scope of this post. But this is the first step in getting to a full-fledged Ember app.</p>

<p>Now all this is a great start and all - but until we can completely transition to Ember router powered views, we need to have ways to communicate between our Ember logic and old application logic.</p>

<h3>Communicating from Ember to non-Ember</h3>

<p>This one is pretty obvious. We pass this responsibility on to the <code>ApplicationController</code> or <code>IndexController</code> based on whichever is more suitable for the scenario:</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="c">&lt;!-- home.html --&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/x-handlebars&quot;</span> <span class="na">data-template-name=</span><span class="s">&quot;index&quot;</span><span class="nt">&gt;</span>
        <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Homepage</span><span class="o">&lt;</span><span class="err">/h1&gt;</span>
        <span class="o">&lt;</span><span class="nx">button</span> <span class="p">{{</span><span class="nx">action</span> <span class="s2">&quot;say-hello&quot;</span><span class="p">}}</span><span class="o">&gt;</span><span class="nx">Say</span> <span class="nx">hello</span><span class="o">!&lt;</span><span class="err">/button&gt;</span>
    <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/body&gt;</span>
</code></pre></div><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">App</span><span class="p">.</span><span class="nx">IndexController</span> <span class="o">=</span> <span class="nx">Em</span><span class="p">.</span><span class="nx">Controller</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">actions</span><span class="o">:</span> <span class="p">{</span>
        <span class="s1">&#39;say-hello&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">Em</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#press-me&#39;</span><span class="p">).</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">})</span>
</code></pre></div>
<h3>Communicating from non-Ember to Ember</h3>

<p>To do things the other way around, we need to make sure the Ember view we want to communicate with has an explicit ID set on it:</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="c">&lt;!-- home.html --&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/x-handlebars&quot;</span> <span class="na">data-template-name=</span><span class="s">&quot;index&quot;</span><span class="nt">&gt;</span>
        <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Homepage</span><span class="o">&lt;</span><span class="err">/h1&gt;</span>
        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&quot;some-button&quot;</span><span class="o">&gt;</span><span class="nx">Trigger</span> <span class="nx">Ember</span> <span class="nx">action</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
        <span class="p">{{</span><span class="nx">ui</span><span class="o">-</span><span class="nx">component</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&quot;some-ember-component&quot;</span><span class="p">}}</span>
    <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/body&gt;</span>
</code></pre></div><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#some-button&#39;</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="c1">// All Ember views in the DOM are referenced under</span>
    <span class="c1">// the `views` object by the element’s ID.</span>
    <span class="kd">var</span> <span class="nx">uiComponent</span> <span class="o">=</span> <span class="nx">Em</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">views</span><span class="p">[</span><span class="s1">&#39;some-ember-component&#39;</span><span class="p">]</span>

    <span class="c1">// Do whatever you like with uiComponent now!</span>
<span class="p">})</span>
</code></pre></div>
<h3>That’s all there is to it <img alt="+1" src="https://github.global.ssl.fastly.net/images/icons/emoji/+1.png" class="emoji" /></h3>

<p>I’ve used this method in several example apps and it has worked great for me so far. I’d love to hear about how other people have gone about dealing with hybrid sites and issues they’ve come across.</p>


            

        

    </div>
</article>

<aside class="content content--pad-bottom">
    <div class="content__box content__body" id="disqus_thread"></div>
</aside>
<script type="text/javascript">
    (function() {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//amsul.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>



    

        <footer class="footer gui-flip">
            <div class="content">
                
                    <div class="content__box content__box--flat">
                        
                            <a class="button-block" href="/">Back to home</a>
                        
                    </div>
                
                <div class="content__box aligncenter">
                    <ul class="list--plain list--inline">
                        <li class="list__item">
                            <a class="button-cube" href="http://twitter.com/amsul_" target="_blank">
                                <span class="gui-icon gui-icon--twitter"></span>
                            </a>
                        </li><!--
                     --><li class="list__item">
                            <a class="button-cube" href="http://github.com/amsul" target="_blank">
                                <span class="gui-icon gui-icon--github"></span>
                            </a>
                        </li><!--
                     --><li class="list__item">
                            <a class="button-cube" href="mailto:reach@amsul.ca">
                                <span class="gui-icon gui-icon--email"></span>
                            </a>
                        </li>
                    </ul>
                    <p>&copy; 2015 Amsul</p>
                    <p class="peace">&#x270C;</p>
                    <p class="embrace">Embrace the randomness.</p>
                </div>
            </div>
        </footer> <!-- .footer -->

    


    <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-34739744-1']);
        _gaq.push(['_trackPageview']);
        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>


</html>


