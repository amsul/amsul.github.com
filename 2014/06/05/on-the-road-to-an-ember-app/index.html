<!doctype html>

<html lang="en">


    <meta charset="utf-8">

    <meta name="author" content="Amsul - http://amsul.ca/">
    <meta name="copyright" content="&copy; Amsul">

    <meta name="viewport" content="width=device-width">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">

    <meta http-equiv="cleartype" content="on">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">


    
        
            <title>On the road to an Ember app / Amsul</title>
        
    


    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:300italic,600italic,800italic,300,600,800">
    <link rel="stylesheet" href="/css/style.css">


    <script src="/js/shiv.js"></script>



    

        <div class="menu">
            <nav class="menu__nav" id="menu">
                <div class="content content--flat-bottom">
                    <a class="menu__button-close" href="#"></a>
                    <div class="content__box">
                        <h4 class="title--flat emphasize">Menu</h4>
                    </div>
                </div>
                <div class="content content-freeform content--pad-bottom">
                    <ul class="list--plain list--flat">
                        <li class="list__item">
                            <a class="link--block" href="/">
                                <div class="content">
                                    <div class="content__box content__box--pad-half">My homepage</div>
                                </div>
                            </a>
                        </li>
                        <li class="list__item">
                            <a class="link--block" href="/notepad">
                                <div class="content">
                                    <div class="content__box content__box--pad-half">My notes on stuff</div>
                                </div>
                            </a>
                        </li>
                        <li class="list__item">
                            <a class="link--block" href="https://github.com/amsul?tab=repositories">
                                <div class="content">
                                    <div class="content__box content__box--pad-half">My open source stuff</div>
                                </div>
                            </a>
                        </li>
                        <li class="list__item">
                            <a class="link--block" href="/me">
                                <div class="content">
                                    <div class="content__box content__box--pad-half">Me and my other stuff</div>
                                </div>
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>
            <aside class="menu__toggler alignright">
                <a class="menu__opener button-menu button-menu--inverse" href="#menu"></a>
                <a class="menu__closer button-menu button-menu--inverse" href="#"></a>
            </aside>
        </div> <!-- .menu -->

    


    <header class="header header--colored">
        <div class="content">
            <div class="content__box content__box--pad-one">
                
                    <h1 class="header__wrapper title--base-size title--thin title--flat">
                        
                            <a class="title--dimmed header__link" href="/">Hi, I&rsquo;m <b>Amsul</b>.</a>
                        
                    </h1>
                
                
                    <div class="header__title aligncenter">
                        
                            <p class="content__subtitle title--dimmed">June 05, 2014</p>
                        
                        
                            <h1 class="title title--thin title--flat">On the road to an Ember app</h1>
                        
                    </div>
                
            </div>
        </div>
    </header> <!-- .header -->


    <article class="content content--pad-bottom">
    <div class="content__box content__body">

        

            <p>I absolutely love <a href="http://emberjs.com/">Ember.js</a>. The framework is extremely powerful and is able to handle so much boilerplate that developing an Ember app is a real joy.</p>

<p>I always imagined that converting an existing large, “multi-page” site into an Ember app would be a complicated process. But it recently occurred to me that it might be easier than expected&hellip; once we sacrifice the router and temporarily transition through a hybrid Ember site.</p>

<h3>The markup</h3>

<p>Let’s say we have a homepage:</p>

<pre><code>&lt;!-- home.html --&gt;
&lt;body&gt;
    &lt;header&gt;&lt;/header&gt;
    &lt;h1&gt;Homepage&lt;/h1&gt;
    &lt;footer&gt;
        &lt;button id="press-me"&gt;Press me!&lt;/button&gt;
    &lt;/footer&gt;
&lt;/body&gt;
</code></pre>

<p>And an about page:</p>

<pre><code>&lt;!-- about.html --&gt;
&lt;body&gt;
    &lt;header&gt;&lt;/header&gt;
    &lt;h1&gt;About&lt;/h1&gt;
    &lt;footer&gt;
        &lt;button id="press-me"&gt;Press me!&lt;/button&gt;
    &lt;/footer&gt;
&lt;/body&gt;
</code></pre>

<p>To Ember-ify this, we basically move all the page-specific content into an “index” template within those pages:</p>

<pre><code>&lt;!-- home.html --&gt;
&lt;body&gt;
    &lt;script type="text/x-handlebars" data-template-name="index"&gt;
        &lt;h1&gt;Homepage&lt;/h1&gt;
    &lt;/script&gt;
&lt;/body&gt;
</code></pre>

<!-- -->


<pre><code>&lt;!-- about.html --&gt;
&lt;body&gt;
    &lt;script type="text/x-handlebars" data-template-name="index"&gt;
        &lt;h1&gt;About&lt;/h1&gt;
    &lt;/script&gt;
&lt;/body&gt;
</code></pre>

<p>And move the rest into the application template:</p>

<pre><code>{{!-- application.hbs --}}
&lt;body&gt;
    &lt;header&gt;&lt;/header&gt;
    {{outlet}}
    &lt;footer&gt;
        &lt;button id="press-me"&gt;Press me!&lt;/button&gt;
    &lt;/footer&gt;
&lt;/body&gt;
</code></pre>

<h3>The scripts</h3>

<p>Let’s say our original scripts are something like this:</p>

<pre><code>function init() {
    $('#press-me').on('click', function() {
        alert('hi there!')
    })
}

// When the document is ready, initialize the scripts.
$(document).ready(init)
</code></pre>

<p>In order to let Ember take over, we need to do some setup <em>before</em> initializing the scripts. So we change it to something like this:</p>

<pre><code>function init() {
    $('#press-me').on('click', function() {
        alert('hi there!')
    })
}

var App = Em.Application.create()

// Disable the router.
App.Router.reopenClass({
    location: 'none'
})

// Once the `index` template of each individual page is
// inserted into the DOM, initialize the non-Ember scripts.
App.IndexView = Em.View.extend({
    didInsertElement: function() {
        init()
    }
})
</code></pre>

<h3>And that’s pretty much it <img alt="smile" src="https://github.global.ssl.fastly.net/images/icons/emoji/smile.png" class="emoji" /></h3>

<p>We got our old application code working as it was before without having to tweak it. And we can build any new features using the power of Ember views.</p>

<p>However, we obviously don’t want to <strong>not</strong> use the epic Ember router. That would be a tragedy. But that is also the trickier part. It heavily depends on your backend setup and your ability to map your URLs over correctly to the Ember router.</p>

<p>That is out of scope of this post. But this is the first step in getting to a full-fledged Ember app.</p>

<p>Now all this is a great start and all - but until we can completely transition to Ember router powered views, we need to have ways to communicate between our Ember logic and old application logic.</p>

<h3>Communicating from Ember to non-Ember</h3>

<p>This one is pretty obvious. We pass this responsibility on to the <code>ApplicationController</code> or <code>IndexController</code> based on whichever is more suitable for the scenario:</p>

<pre><code>&lt;!-- home.html --&gt;
&lt;body&gt;
    &lt;script type="text/x-handlebars" data-template-name="index"&gt;
        &lt;h1&gt;Homepage&lt;/h1&gt;
        &lt;button {{action "say-hello"}}&gt;Say hello!&lt;/button&gt;
    &lt;/script&gt;
&lt;/body&gt;
</code></pre>

<!-- -->


<pre><code>App.IndexController = Em.Controller.extend({
    actions: {
        'say-hello': function() {
            Em.$('#press-me').trigger('click')
        }
    }
})
</code></pre>

<h3>Communicating from non-Ember to Ember</h3>

<p>To do things the other way around, we need to make sure the Ember view we want to communicate with has an explicit ID set on it:</p>

<pre><code>&lt;!-- home.html --&gt;
&lt;body&gt;
    &lt;script type="text/x-handlebars" data-template-name="index"&gt;
        &lt;h1&gt;Homepage&lt;/h1&gt;
        &lt;button id="some-button"&gt;Trigger Ember action&lt;/button&gt;
        {{ui-component id="some-ember-component"}}
    &lt;/script&gt;
&lt;/body&gt;
</code></pre>

<!-- -->


<pre><code>$('#some-button').on('click', function() {

    // All Ember views in the DOM are referenced under
    // the `views` object by the element’s ID.
    var uiComponent = Em.View.views['some-ember-component']

    // Do whatever you like with uiComponent now!
})
</code></pre>

<h3>That’s all there is to it <img alt="+1" src="https://github.global.ssl.fastly.net/images/icons/emoji/+1.png" class="emoji" /></h3>

<p>I’ve used this method in several example apps and it has worked great for me so far. I’d love to hear about how other people have gone about dealing with hybrid sites and issues they’ve come across.</p>


            

        

    </div>
</article>


    

        <footer class="footer gui-flip">
            <div class="content">
                
                    <div class="content__box content__box--flat-top">
                        <a class="button-block" href="https://twitter.com/intent/tweet?text=@amsul_&url=http%3A%2F%2Famsul.ca%2F2014%2F06%2F05%2Fon-the-road-to-an-ember-app%2F" target="_blank">Share your comments/questions</a>
                    </div>
                    <div class="content__box content__box--flat">
                        
                            <a class="button-block" href="/">Back to home</a>
                        
                    </div>
                
                <div class="content__box aligncenter">
                    <ul class="list--plain list--inline">
                        <li class="list__item">
                            <a class="button-cube" href="http://twitter.com/amsul_" target="_blank">
                                <span class="gui-icon gui-icon--twitter"></span>
                            </a>
                        </li><!--
                     --><li class="list__item">
                            <a class="button-cube" href="http://github.com/amsul" target="_blank">
                                <span class="gui-icon gui-icon--github"></span>
                            </a>
                        </li><!--
                     --><li class="list__item">
                            <a class="button-cube" href="mailto:reach@amsul.ca">
                                <span class="gui-icon gui-icon--email"></span>
                            </a>
                        </li>
                    </ul>
                    <p>&copy; 2014 Amsul</p>
                    <p class="peace">&#x270C;</p>
                    <p class="embrace">Embrace the randomness.</p>
                </div>
            </div>
        </footer> <!-- .footer -->

    


    <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-34739744-1']);
        _gaq.push(['_trackPageview']);
        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>


</html>


